{"version":3,"file":"use-spring-BwAbBgG4.js","sources":["../../node_modules/motion-dom/dist/es/value/spring-value.mjs","../../node_modules/framer-motion/dist/es/value/use-spring.mjs"],"sourcesContent":["import { motionValue } from './index.mjs';\nimport { JSAnimation } from '../animation/JSAnimation.mjs';\nimport { isMotionValue } from './utils/is-motion-value.mjs';\nimport { frame } from '../frameloop/frame.mjs';\n\n/**\n * Create a `MotionValue` that animates to its latest value using a spring.\n * Can either be a value or track another `MotionValue`.\n *\n * ```jsx\n * const x = motionValue(0)\n * const y = transformValue(() => x.get() * 2) // double x\n * ```\n *\n * @param transformer - A transform function. This function must be pure with no side-effects or conditional statements.\n * @returns `MotionValue`\n *\n * @public\n */\nfunction springValue(source, options) {\n    const initialValue = isMotionValue(source) ? source.get() : source;\n    const value = motionValue(initialValue);\n    attachSpring(value, source, options);\n    return value;\n}\nfunction attachSpring(value, source, options) {\n    const initialValue = value.get();\n    let activeAnimation = null;\n    let latestValue = initialValue;\n    let latestSetter;\n    const unit = typeof initialValue === \"string\"\n        ? initialValue.replace(/[\\d.-]/g, \"\")\n        : undefined;\n    const stopAnimation = () => {\n        if (activeAnimation) {\n            activeAnimation.stop();\n            activeAnimation = null;\n        }\n    };\n    const startAnimation = () => {\n        stopAnimation();\n        activeAnimation = new JSAnimation({\n            keyframes: [asNumber(value.get()), asNumber(latestValue)],\n            velocity: value.getVelocity(),\n            type: \"spring\",\n            restDelta: 0.001,\n            restSpeed: 0.01,\n            ...options,\n            onUpdate: latestSetter,\n        });\n    };\n    value.attach((v, set) => {\n        latestValue = v;\n        latestSetter = (latest) => set(parseValue(latest, unit));\n        frame.postRender(startAnimation);\n    }, stopAnimation);\n    if (isMotionValue(source)) {\n        const removeSourceOnChange = source.on(\"change\", (v) => value.set(parseValue(v, unit)));\n        const removeValueOnDestroy = value.on(\"destroy\", removeSourceOnChange);\n        return () => {\n            removeSourceOnChange();\n            removeValueOnDestroy();\n        };\n    }\n    return stopAnimation;\n}\nfunction parseValue(v, unit) {\n    return unit ? v + unit : v;\n}\nfunction asNumber(v) {\n    return typeof v === \"number\" ? v : parseFloat(v);\n}\n\nexport { attachSpring, springValue };\n","\"use client\";\nimport { attachSpring, isMotionValue } from 'motion-dom';\nimport { useContext, useInsertionEffect } from 'react';\nimport { MotionConfigContext } from '../context/MotionConfigContext.mjs';\nimport { useMotionValue } from './use-motion-value.mjs';\nimport { useTransform } from './use-transform.mjs';\n\nfunction useSpring(source, options = {}) {\n    const { isStatic } = useContext(MotionConfigContext);\n    const getFromSource = () => (isMotionValue(source) ? source.get() : source);\n    // isStatic will never change, allowing early hooks return\n    if (isStatic) {\n        return useTransform(getFromSource);\n    }\n    const value = useMotionValue(getFromSource());\n    useInsertionEffect(() => {\n        return attachSpring(value, source, options);\n    }, [value, JSON.stringify(options)]);\n    return value;\n}\n\nexport { useSpring };\n"],"names":["attachSpring","value","source","options","initialValue","activeAnimation","latestValue","latestSetter","unit","stopAnimation","startAnimation","JSAnimation","asNumber","v","set","latest","parseValue","frame","isMotionValue","removeSourceOnChange","removeValueOnDestroy","useSpring","isStatic","useContext","MotionConfigContext","getFromSource","useTransform","useMotionValue","useInsertionEffect"],"mappings":"6EAyBA,SAASA,EAAaC,EAAOC,EAAQC,EAAS,CAC1C,MAAMC,EAAeH,EAAM,IAAG,EAC9B,IAAII,EAAkB,KAClBC,EAAcF,EACdG,EACJ,MAAMC,EAAO,OAAOJ,GAAiB,SAC/BA,EAAa,QAAQ,UAAW,EAAE,EAClC,OACAK,EAAgB,IAAM,CACpBJ,IACAA,EAAgB,KAAI,EACpBA,EAAkB,KAE1B,EACMK,EAAiB,IAAM,CACzBD,EAAa,EACbJ,EAAkB,IAAIM,EAAY,CAC9B,UAAW,CAACC,EAASX,EAAM,IAAG,CAAE,EAAGW,EAASN,CAAW,CAAC,EACxD,SAAUL,EAAM,YAAW,EAC3B,KAAM,SACN,UAAW,KACX,UAAW,IACX,GAAGE,EACH,SAAUI,CACtB,CAAS,CACL,EAMA,GALAN,EAAM,OAAO,CAACY,EAAGC,IAAQ,CACrBR,EAAcO,EACdN,EAAgBQ,GAAWD,EAAIE,EAAWD,EAAQP,CAAI,CAAC,EACvDS,EAAM,WAAWP,CAAc,CACnC,EAAGD,CAAa,EACZS,EAAchB,CAAM,EAAG,CACvB,MAAMiB,EAAuBjB,EAAO,GAAG,SAAWW,GAAMZ,EAAM,IAAIe,EAAWH,EAAGL,CAAI,CAAC,CAAC,EAChFY,EAAuBnB,EAAM,GAAG,UAAWkB,CAAoB,EACrE,MAAO,IAAM,CACTA,EAAoB,EACpBC,EAAoB,CACxB,CACJ,CACA,OAAOX,CACX,CACA,SAASO,EAAWH,EAAGL,EAAM,CACzB,OAAOA,EAAOK,EAAIL,EAAOK,CAC7B,CACA,SAASD,EAASC,EAAG,CACjB,OAAO,OAAOA,GAAM,SAAWA,EAAI,WAAWA,CAAC,CACnD,CChEA,SAASQ,EAAUnB,EAAQC,EAAU,GAAI,CACrC,KAAM,CAAE,SAAAmB,CAAQ,EAAKC,EAAAA,WAAWC,CAAmB,EAC7CC,EAAgB,IAAOP,EAAchB,CAAM,EAAIA,EAAO,IAAG,EAAKA,EAEpE,GAAIoB,EACA,OAAOI,EAAaD,CAAa,EAErC,MAAMxB,EAAQ0B,EAAeF,GAAe,EAC5CG,OAAAA,EAAAA,mBAAmB,IACR5B,EAAaC,EAAOC,EAAQC,CAAO,EAC3C,CAACF,EAAO,KAAK,UAAUE,CAAO,CAAC,CAAC,EAC5BF,CACX","x_google_ignoreList":[0,1]}